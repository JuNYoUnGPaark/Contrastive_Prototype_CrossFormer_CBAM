
================================================================================
   ğŸ§ª UCI-HAR Comprehensive Comparison (âœ¨ OPTIMIZED)
   SUPERVISED vs TRUE SELF-SUPERVISED LEARNING
   Architecture: ResNet + Transformer Encoder
================================================================================

   ğŸ“‹ ì‹¤í—˜ ì„¤ê³„:
   1. ë™ì¼í•œ ë°±ë³¸ (ResNet + Transformer)
   2. 2ë ˆë²¨ ì „ì´ ë°ì´í„°ì…‹ (Moderate/Strong)
   3. 6ê°€ì§€ ì„¤ì • ë¹„êµ:
      â”œâ”€ Supervised Ã— (Linear, Hyperbolic)
      â”œâ”€ SSL Linear Eval Ã— (Linear, Hyperbolic)
      â””â”€ SSL Fine-tune Ã— (Linear, Hyperbolic)
================================================================================

   âš™ï¸  Supervised ì„¤ì •:
   - Epochs: 50
   - Batch size: 128
   - Learning rate: 0.0003
   - Warmup: 0 epochs
   - EMA decay: Disabled
   - Consistency weight: 0.0
   - Training: End-to-end with labels + consistency loss

   âš™ï¸  SSL ì„¤ì •:
   - Stage 1 (Pretrain): 100 epochs, batch=512, lr=0.001
     â†’ Contrastive learning only (NO LABELS)
     â†’ Label-independent augmentation
     â†’ Warmup: 0 epochs
     â†’ EMA decay: Disabled
   - Stage 2 (Eval/FT): 50 epochs, batch=128, lr=0.0003
     â†’ Linear Eval: Freeze backbone
     â†’ Fine-tune: Train all (backbone LR Ã— 0.1)
     â†’ Consistency weight: 0.0

   ğŸ”§ Augmentations (SSL - Optimized):
   - Jitter (scale=0.05)
   - Scaling (range=(0.8, 1.2))
   - Channel Drop (prob=0.2)
   - Time Warp (prob=0.1) âœ… 0.3â†’0.10
   - Cutout (prob=0.2, ratio=0.1) âœ… 0.2â†’0.10
   - ALL label-independent!

   ğŸ—ï¸  Architecture:
   - Backbone: ResNet(layers=[2,2,2]) + Transformer(heads=4, layers=2)
   - d_model: 128, dropout: 0.1
   - Classifier: Linear vs Hyperbolic (c_init=1.0, learnable âœ…)
   - Projection dim (SSL): 128

   ğŸ”¬ SSL Contrastive Learning:
   - Loss: NT-Xent (InfoNCE)
   - Temperature: 0.07
   - Negative samples: 2*batch_size - 2

   âœ¨ ìµœì í™” ê°œì„ ì‚¬í•­:
   - ì •ê·œí™” ë²„ê·¸ ìˆ˜ì • (ì „ì´ í…ŒìŠ¤íŠ¸ì…‹)
   - Cosine Annealing + Warmup
   - EMA (Exponential Moving Average)
   - ë°±ë³¸/í—¤ë“œ ë¶„ë¦¬ í•™ìŠµë¥  (Fine-tune)
   - ì „ì´-ìœ ì‚¬ ì¼ê´€ì„± ì†ì‹¤ (Tail-Head Stitch)
   - ì¦ê°• ê°•ë„ ìµœì í™” (ê²½ê³„ ì •ë³´ ë³´ì¡´)
   - í•™ìŠµ ê°€ëŠ¥í•œ Hyperbolic c
   - 2ë ˆë²¨ ì „ì´ ì‹œë‚˜ë¦¬ì˜¤ (Moderate/Strong)
================================================================================


ğŸ“¦ Loading UCI-HAR Dataset...
[OK] train: X(7352, 9, 128), y(7352,)
[OK] test: X(2947, 9, 128), y(2947,)
   - Train samples: 7352
   - Test samples: 2947

================================================================================
    ğŸ”¬ TRANSITIONAL TEST SETS ìƒì„± (2ë ˆë²¨ ê°•ë„)
================================================================================
   - [Moderate] STANDINGâ†”SITTING (p=0.50, mix=0.40): 511ê°œ ìƒ˜í”Œ ë³€í˜•
   - [Moderate] WALKINGâ†”WALKING_UPSTAIRS (p=0.55, mix=0.42): 531ê°œ ìƒ˜í”Œ ë³€í˜•
   - [Strong] STANDINGâ†”SITTING (p=0.70, mix=0.55): 715ê°œ ìƒ˜í”Œ ë³€í˜•
   - [Strong] WALKINGâ†”WALKING_UPSTAIRS (p=0.65, mix=0.52): 628ê°œ ìƒ˜í”Œ ë³€í˜•
   - [Strong] SITTINGâ†”LAYING (p=0.75, mix=0.58): 770ê°œ ìƒ˜í”Œ ë³€í˜•

================================================================================
   ì‹¤í—˜: Supervised_Linear
================================================================================

ğŸ“š Supervised Learning (With Labels)
--------------------------------------------------------------------------------
Training for 50 epochs...
[Supervised 01/50] Train L:0.5001 CE:0.5001 Cons:0.0000 A:0.8864 | Test A:0.9260 F1:0.9269
[Supervised 10/50] Train L:0.3215 CE:0.3215 Cons:0.0000 A:0.9597 | Test A:0.9328 F1:0.9328
[Supervised 20/50] Train L:0.3040 CE:0.3040 Cons:0.0000 A:0.9642 | Test A:0.9284 F1:0.9290
[Supervised 30/50] Train L:0.2881 CE:0.2881 Cons:0.0000 A:0.9748 | Test A:0.9413 F1:0.9416
[Supervised 40/50] Train L:0.2874 CE:0.2874 Cons:0.0000 A:0.9769 | Test A:0.9525 F1:0.9532
[Supervised 50/50] Train L:0.2775 CE:0.2775 Cons:0.0000 A:0.9826 | Test A:0.9454 F1:0.9457
âœ… Best Test Acc: 0.9545

   ğŸ” ì „ì´ í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€...
     - [Moderate] Scenario 1 (STANDINGâ†”SITTING): Acc=0.9111 F1=0.9128 (Drop=0.0434)
     - [Moderate] Scenario 2 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.9091 F1=0.9085 (Drop=0.0455)
     - [Strong] Scenario 3 (STANDINGâ†”SITTING): Acc=0.8585 F1=0.8620 (Drop=0.0960)
     - [Strong] Scenario 4 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8388 F1=0.8344 (Drop=0.1157)
     - [Strong] Scenario 5 (SITTINGâ†”LAYING): Acc=0.8120 F1=0.8124 (Drop=0.1425)

================================================================================
   ì‹¤í—˜: Supervised_Hyperbolic
================================================================================

ğŸ“š Supervised Learning (With Labels)
--------------------------------------------------------------------------------
Training for 50 epochs...
[Supervised 01/50] Train L:1.4078 CE:1.4078 Cons:0.0000 A:0.8394 | Test A:0.9209 F1:0.9208
[Supervised 10/50] Train L:0.5614 CE:0.5614 Cons:0.0000 A:0.9589 | Test A:0.9002 F1:0.9013
[Supervised 20/50] Train L:0.3679 CE:0.3679 Cons:0.0000 A:0.9640 | Test A:0.9291 F1:0.9309
[Supervised 30/50] Train L:0.3104 CE:0.3104 Cons:0.0000 A:0.9763 | Test A:0.9253 F1:0.9262
[Supervised 40/50] Train L:0.2853 CE:0.2853 Cons:0.0000 A:0.9791 | Test A:0.9403 F1:0.9419
[Supervised 50/50] Train L:0.2724 CE:0.2724 Cons:0.0000 A:0.9879 | Test A:0.9505 F1:0.9505
âœ… Best Test Acc: 0.9505

   ğŸ” ì „ì´ í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€...
     - [Moderate] Scenario 1 (STANDINGâ†”SITTING): Acc=0.9036 F1=0.9022 (Drop=0.0468)
     - [Moderate] Scenario 2 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8907 F1=0.8892 (Drop=0.0597)
     - [Strong] Scenario 3 (STANDINGâ†”SITTING): Acc=0.8510 F1=0.8466 (Drop=0.0994)
     - [Strong] Scenario 4 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8334 F1=0.8282 (Drop=0.1171)
     - [Strong] Scenario 5 (SITTINGâ†”LAYING): Acc=0.8327 F1=0.8129 (Drop=0.1177)

================================================================================
   ì‹¤í—˜: SSL_LinearEval_Linear
================================================================================

ğŸ“š Stage 1: Self-Supervised Pretraining (No Labels)
--------------------------------------------------------------------------------
Pretraining for 100 epochs...
[Pretrain 001/100] SSL Loss: 4.8186
[Pretrain 010/100] SSL Loss: 1.8973
[Pretrain 020/100] SSL Loss: 1.0982
[Pretrain 030/100] SSL Loss: 1.0177
[Pretrain 040/100] SSL Loss: 1.0625
[Pretrain 050/100] SSL Loss: 0.8192
[Pretrain 060/100] SSL Loss: 0.7844
[Pretrain 070/100] SSL Loss: 0.7696
[Pretrain 080/100] SSL Loss: 0.8754
[Pretrain 090/100] SSL Loss: 0.5887
[Pretrain 100/100] SSL Loss: 0.6765
âœ… Pretraining Complete!

ğŸ“š Stage 2: LINEAR_EVAL (With Labels)
--------------------------------------------------------------------------------
linear_eval for 50 epochs...
[linear_eval 01/50] Train L:1.8074 A:0.2393 | Test A:0.4581 F1:0.4450
[linear_eval 10/50] Train L:0.5546 A:0.9125 | Test A:0.8955 F1:0.8941
[linear_eval 20/50] Train L:0.4666 A:0.9264 | Test A:0.9063 F1:0.9056
[linear_eval 30/50] Train L:0.4429 A:0.9342 | Test A:0.9108 F1:0.9101
[linear_eval 40/50] Train L:0.4306 A:0.9380 | Test A:0.9121 F1:0.9115
[linear_eval 50/50] Train L:0.4221 A:0.9418 | Test A:0.9128 F1:0.9123
âœ… Best Test Acc: 0.9138

   ğŸ” ì „ì´ í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€...
     - [Moderate] Scenario 1 (STANDINGâ†”SITTING): Acc=0.8890 F1=0.8891 (Drop=0.0248)
     - [Moderate] Scenario 2 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8616 F1=0.8579 (Drop=0.0523)
     - [Strong] Scenario 3 (STANDINGâ†”SITTING): Acc=0.8293 F1=0.8314 (Drop=0.0845)
     - [Strong] Scenario 4 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8008 F1=0.7923 (Drop=0.1130)
     - [Strong] Scenario 5 (SITTINGâ†”LAYING): Acc=0.7760 F1=0.7806 (Drop=0.1378)

================================================================================
   ì‹¤í—˜: SSL_LinearEval_Hyperbolic
================================================================================

ğŸ“š Stage 1: Self-Supervised Pretraining (No Labels)
--------------------------------------------------------------------------------
Pretraining for 100 epochs...
[Pretrain 001/100] SSL Loss: 4.8186
[Pretrain 010/100] SSL Loss: 1.8973
[Pretrain 020/100] SSL Loss: 1.0982
[Pretrain 030/100] SSL Loss: 1.0177
[Pretrain 040/100] SSL Loss: 1.0625
[Pretrain 050/100] SSL Loss: 0.8192
[Pretrain 060/100] SSL Loss: 0.7844
[Pretrain 070/100] SSL Loss: 0.7696
[Pretrain 080/100] SSL Loss: 0.8754
[Pretrain 090/100] SSL Loss: 0.5887
[Pretrain 100/100] SSL Loss: 0.6765
âœ… Pretraining Complete!

ğŸ“š Stage 2: LINEAR_EVAL (With Labels)
--------------------------------------------------------------------------------
linear_eval for 50 epochs...
[linear_eval 01/50] Train L:1.6645 A:0.6007 | Test A:0.8392 F1:0.8281
[linear_eval 10/50] Train L:0.6622 A:0.9298 | Test A:0.9094 F1:0.9086
[linear_eval 20/50] Train L:0.4351 A:0.9411 | Test A:0.9192 F1:0.9186
[linear_eval 30/50] Train L:0.3778 A:0.9497 | Test A:0.9189 F1:0.9182
[linear_eval 40/50] Train L:0.3584 A:0.9524 | Test A:0.9237 F1:0.9231
[linear_eval 50/50] Train L:0.3506 A:0.9559 | Test A:0.9233 F1:0.9227
âœ… Best Test Acc: 0.9277

   ğŸ” ì „ì´ í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€...
     - [Moderate] Scenario 1 (STANDINGâ†”SITTING): Acc=0.8999 F1=0.9006 (Drop=0.0278)
     - [Moderate] Scenario 2 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8775 F1=0.8744 (Drop=0.0502)
     - [Strong] Scenario 3 (STANDINGâ†”SITTING): Acc=0.8303 F1=0.8335 (Drop=0.0974)
     - [Strong] Scenario 4 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8059 F1=0.7974 (Drop=0.1218)
     - [Strong] Scenario 5 (SITTINGâ†”LAYING): Acc=0.7679 F1=0.7724 (Drop=0.1598)

================================================================================
   ì‹¤í—˜: SSL_FineTune_Linear
================================================================================

ğŸ“š Stage 1: Self-Supervised Pretraining (No Labels)
--------------------------------------------------------------------------------
Pretraining for 100 epochs...
[Pretrain 001/100] SSL Loss: 4.8186
[Pretrain 010/100] SSL Loss: 1.8973
[Pretrain 020/100] SSL Loss: 1.0982
[Pretrain 030/100] SSL Loss: 1.0177
[Pretrain 040/100] SSL Loss: 1.0625
[Pretrain 050/100] SSL Loss: 0.8192
[Pretrain 060/100] SSL Loss: 0.7844
[Pretrain 070/100] SSL Loss: 0.7696
[Pretrain 080/100] SSL Loss: 0.8754
[Pretrain 090/100] SSL Loss: 0.5887
[Pretrain 100/100] SSL Loss: 0.6765
âœ… Pretraining Complete!

ğŸ“š Stage 2: FINETUNE (With Labels)
--------------------------------------------------------------------------------
finetune for 50 epochs...
[finetune 01/50] Train L:1.4352 CE:1.4352 Cons:0.0000 A:0.5197 | Test A:0.8514 F1:0.8502
[finetune 10/50] Train L:0.3074 CE:0.3074 Cons:0.0000 A:0.9693 | Test A:0.9566 F1:0.9566
[finetune 20/50] Train L:0.2734 CE:0.2734 Cons:0.0000 A:0.9861 | Test A:0.9674 F1:0.9674
[finetune 30/50] Train L:0.2644 CE:0.2644 Cons:0.0000 A:0.9913 | Test A:0.9701 F1:0.9701
[finetune 40/50] Train L:0.2603 CE:0.2603 Cons:0.0000 A:0.9931 | Test A:0.9684 F1:0.9684
[finetune 50/50] Train L:0.2585 CE:0.2585 Cons:0.0000 A:0.9932 | Test A:0.9695 F1:0.9695
âœ… Best Test Acc: 0.9708

   ğŸ” ì „ì´ í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€...
     - [Moderate] Scenario 1 (STANDINGâ†”SITTING): Acc=0.9213 F1=0.9224 (Drop=0.0495)
     - [Moderate] Scenario 2 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.9135 F1=0.9112 (Drop=0.0573)
     - [Strong] Scenario 3 (STANDINGâ†”SITTING): Acc=0.8381 F1=0.8413 (Drop=0.1327)
     - [Strong] Scenario 4 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8588 F1=0.8518 (Drop=0.1120)
     - [Strong] Scenario 5 (SITTINGâ†”LAYING): Acc=0.8178 F1=0.8124 (Drop=0.1530)

================================================================================
   ì‹¤í—˜: SSL_FineTune_Hyperbolic
================================================================================

ğŸ“š Stage 1: Self-Supervised Pretraining (No Labels)
--------------------------------------------------------------------------------
Pretraining for 100 epochs...
[Pretrain 001/100] SSL Loss: 4.8186
[Pretrain 010/100] SSL Loss: 1.8973
[Pretrain 020/100] SSL Loss: 1.0982
[Pretrain 030/100] SSL Loss: 1.0177
[Pretrain 040/100] SSL Loss: 1.0625
[Pretrain 050/100] SSL Loss: 0.8192
[Pretrain 060/100] SSL Loss: 0.7844
[Pretrain 070/100] SSL Loss: 0.7696
[Pretrain 080/100] SSL Loss: 0.8754
[Pretrain 090/100] SSL Loss: 0.5887
[Pretrain 100/100] SSL Loss: 0.6765
âœ… Pretraining Complete!

ğŸ“š Stage 2: FINETUNE (With Labels)
--------------------------------------------------------------------------------
finetune for 50 epochs...
[finetune 01/50] Train L:1.6141 CE:1.6141 Cons:0.0000 A:0.6625 | Test A:0.8884 F1:0.8839
[finetune 10/50] Train L:0.5404 CE:0.5404 Cons:0.0000 A:0.9699 | Test A:0.9535 F1:0.9537
[finetune 20/50] Train L:0.3409 CE:0.3409 Cons:0.0000 A:0.9879 | Test A:0.9688 F1:0.9688
[finetune 30/50] Train L:0.2995 CE:0.2995 Cons:0.0000 A:0.9890 | Test A:0.9698 F1:0.9699
[finetune 40/50] Train L:0.2814 CE:0.2814 Cons:0.0000 A:0.9935 | Test A:0.9701 F1:0.9702
[finetune 50/50] Train L:0.2773 CE:0.2773 Cons:0.0000 A:0.9950 | Test A:0.9701 F1:0.9702
âœ… Best Test Acc: 0.9718

   ğŸ” ì „ì´ í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€...
     - [Moderate] Scenario 1 (STANDINGâ†”SITTING): Acc=0.9209 F1=0.9217 (Drop=0.0509)
     - [Moderate] Scenario 2 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.9063 F1=0.9032 (Drop=0.0655)
     - [Strong] Scenario 3 (STANDINGâ†”SITTING): Acc=0.8409 F1=0.8426 (Drop=0.1310)
     - [Strong] Scenario 4 (WALKINGâ†”WALKING_UPSTAIRS): Acc=0.8683 F1=0.8596 (Drop=0.1035)
     - [Strong] Scenario 5 (SITTINGâ†”LAYING): Acc=0.7879 F1=0.7935 (Drop=0.1839)

================================================================================
   ğŸ“Š SUPERVISED vs TRUE SSL ì‹¤í—˜ ê²°ê³¼ (ìµœì í™” ë²„ì „)
================================================================================
Config                              Method       Mode         Classifier   Orig Acc   Trans Acc   Drop       Retention 
-------------------------------------------------------------------------------------------------------------------
Supervised_Linear                   supervised   supervised   Linear       0.9545     0.8659      0.0886  90.71%
Supervised_Hyperbolic               supervised   supervised   Hyperbolic   0.9505     0.8623      0.0882  90.72%
SSL_LinearEval_Linear               ssl          linear_eval  Linear       0.9138     0.8314      0.0825  90.98%
SSL_LinearEval_Hyperbolic           ssl          linear_eval  Hyperbolic   0.9277     0.8363      0.0914  90.15%
SSL_FineTune_Linear                 ssl          finetune     Linear       0.9708     0.8699      0.1009  89.61%
SSL_FineTune_Hyperbolic             ssl          finetune     Hyperbolic   0.9718     0.8649      0.1070  88.99%

================================================================================
ğŸ“Š ë ˆë²¨ë³„ Retention ë¶„ì„
================================================================================
Config                              Overall      Moderate     Strong      
--------------------------------------------------------------------------------
Supervised_Linear                    90.71%       95.34%        87.63%
Supervised_Hyperbolic                90.72%       94.39%        88.28%
SSL_LinearEval_Linear                90.98%       95.79%        87.77%
SSL_LinearEval_Hyperbolic            90.15%       95.79%        86.38%
SSL_FineTune_Linear                  89.61%       94.49%        86.35%
SSL_FineTune_Hyperbolic              88.99%       94.01%        85.65%

================================================================================
ğŸ“Š ìƒì„¸ ë¹„êµ ë¶„ì„
================================================================================

ğŸ† ìµœì¢… ì„±ëŠ¥ ë­í‚¹ (Overall Retention ê¸°ì¤€)
--------------------------------------------------------------------------------
   1. SSL_LinearEval_Linear               (ssl-linear_eval     ) Retention: 90.98% (Mod: 95.79% | Str: 87.77%)
   2. Supervised_Hyperbolic               (supervised          ) Retention: 90.72% (Mod: 94.39% | Str: 88.28%)
   3. Supervised_Linear                   (supervised          ) Retention: 90.71% (Mod: 95.34% | Str: 87.63%)
   4. SSL_LinearEval_Hyperbolic           (ssl-linear_eval     ) Retention: 90.15% (Mod: 95.79% | Str: 86.38%)
   5. SSL_FineTune_Linear                 (ssl-finetune        ) Retention: 89.61% (Mod: 94.49% | Str: 86.35%)
   6. SSL_FineTune_Hyperbolic             (ssl-finetune        ) Retention: 88.99% (Mod: 94.01% | Str: 85.65%)

================================================================================
ğŸ¯ ê²°ë¡ 
================================================================================
   - ìµœê³  ì„±ëŠ¥: SSL_LinearEval_Linear (Retention: 90.98%)
   - Supervised baseline: 90.72% (Mod: 94.39% | Str: 88.28%)
   - SSL best: 90.98% (Mod: 95.79% | Str: 87.77%)
   - Performance gap: 0.25pp

   âœ¨ ìµœì í™” ê°œì„ ì‚¬í•­:
   - ì •ê·œí™” ë²„ê·¸ ìˆ˜ì • âœ…
   - Cosine + Warmup ìŠ¤ì¼€ì¤„ëŸ¬ âœ…
   - EMA (Exponential Moving Average) âœ…
   - ë°±ë³¸/í—¤ë“œ ë¶„ë¦¬ í•™ìŠµë¥  (Fine-tune) âœ…
   - ì „ì´-ìœ ì‚¬ ì¼ê´€ì„± ì†ì‹¤ (Tail-Head Stitch) âœ…
   - ì¦ê°• ê°•ë„ ìµœì í™” (warp: 0.10, cutout: 0.10) âœ…
   - í•™ìŠµ ê°€ëŠ¥í•œ Hyperbolic c âœ…
   - 2ë ˆë²¨ ì „ì´ ì‹œë‚˜ë¦¬ì˜¤ (Moderate/Strong) âœ…

âœ… Results saved to:
   - C://Users/park9/HAR/SSL_HAR/RESULTS/IMPROVE/cons+ema+CosOFF\supervised_vs_ssl_results_optimized.json
   - C://Users/park9/HAR/SSL_HAR/RESULTS/IMPROVE/cons+ema+CosOFF\visualization_data_optimized.json
================================================================================
